# EDINET 報告書ビューア アプリ

## ソフトウェア要求仕様書（SRS）

---

## 0. ドキュメント情報

* **文書名**：EDINET 報告書ビューア アプリ ソフトウェア要求仕様書（SRS）
* **作成者**：
* **バージョン**：v0.2（ドラフト）
* **作成日**：2025-xx-xx
* **更新履歴**：

  * v0.2：期間検索入力、並び順、ダウンロード処理の仕様を追記
  * v0.1：初版ドラフト作成

---

## 1. はじめに（Introduction）

### 1.1 目的（Purpose）

本書は、EDINET から企業の有価証券報告書、半期報告書、四半期報告書などの法定開示書類を取得し、その内容を Streamlit アプリとして表示するツール（以下「本アプリ」）のソフトウェア要求を定義することを目的とする。また、本アプリは以下の目的も併せて持つ：

* 法定開示書類を **GitHub Pages で作成するブログ用に Markdown に変換** すること
* 売上高などの財務データをもとに、**Instagram 投稿用の画像作成に利用できる元データを生成** すること

対象読者は以下とする：

* 本アプリの開発者
* レビュー担当者
* 将来の保守担当者

### 1.2 範囲（Scope）（Scope）

本アプリは、EDINET から有価証券報告書、半期報告書、四半期報告書などの提出書類を取得し、以下を実現する：

* 企業の EDINET 提出書類（有価証券報告書、半期報告書、四半期報告書など）を検索・取得
* 提出書類ファイルのダウンロード
* 内容の自動抽出（主要財務数値）
* Streamlit 上での表・グラフ・テキスト表示

### 1.3 用語定義（Definitions）

* **EDINET**：金融庁が提供する電子開示システム。
* **有価証券報告書／半期報告書／四半期報告書**：企業が EDINET に提出する法定開示書類。
* **Streamlit**：Python 製の Web アプリケーションフレームワーク。
* **ユーザー**：本アプリの利用者。

### 1.4 参照文書（References）

* EDINET API 仕様書
* 金融庁 EDINET サイト
* 社内運用ルール（必要に応じて）

### 1.5 文書構成（Overview）

本書は、本アプリの概要、外部インターフェース、機能要求、非機能要求、および将来拡張について記述する。

---

## 2. 全体概要（Overall Description）

### 2.1 製品の位置づけ（Product Perspective）

本アプリは、個人・社内向けの法定開示書類閲覧用ツールであり、Python/Streamlit を用いてローカル環境で動作する Web UI アプリとして提供される。

### 2.2 ユーザー分類（User Classes and Characteristics）

* **一般ユーザー**：投資や企業分析を行うユーザー。Python の知識なしでも利用可能。
* **開発者**：Python / Streamlit による保守・改修を行う担当者。

### 2.3 運用環境（Operating Environment）

* OS：Windows 10 / 11
* Python：3.10 以上
* 使用ライブラリ：streamlit, requests, pandas など
* PDF/XBRL 読み取りライブラリ（必要に応じて）

### 2.4 制約条件（Design and Implementation Constraints）

* EDINET API の利用制限に従う
* 過度なリクエストを送信しない
* 基本的にローカル実行（Web公開は想定外）

### 2.5 想定・依存関係（Assumptions and Dependencies）

* ユーザーの PC はインターネット接続可能
* EDINET サービスが稼働していること
* EDINET API 仕様が大きく変更されないこと

---

## 3. 外部インターフェース要求（External Interface Requirements）

### 3.1 ユーザーインターフェース（UI）

Streamlit による Web UI を提供する。

#### 3.1.1 画面構成

1. **検索条件入力エリア**

   * 企業コード / 銘柄コード / EDINET コード
   * 提出日（開始日・終了日の範囲入力。開始日≦終了日で必須）
    * 書類種別（有価証券報告書／半期報告書／四半期報告書などの EDINET 提出書類）

2. **検索結果一覧**

   * 書類名、提出日、提出者名などをテーブルで表示
   * 「詳細表示」ボタンを設置
   * 各行に PDF/XBRL を取得するための「ダウンロード」ボタンまたはリンクを設置

3. **財務内容表示エリア**

   * 主要財務項目の表表示
   * 売上高・利益などのグラフ表示
   * コメント表示

4. **ステータス表示**

   * データ取得中のメッセージやエラー表示

5. **設定画面**

   * EDINET の API キーを入力するテキスト入力欄
   * 入力した API キーを保存するための「保存」ボタン
   * 保存状態（例：未設定／設定済み）を表示するステータス

### 3.2 ハードウェアインターフェース

特になし

### 3.3 ソフトウェアインターフェース

* EDINET API（HTTP/HTTPS）
* ローカルファイルシステム（PDF/XBRL 保存）

### 3.4 通信インターフェース

* HTTP/HTTPS
* 必要に応じてプロキシ設定対応

---

## 4. 機能要求（Specific Functional Requirements）

### **FR-001：書類検索条件の入力**

* **概要**：ユーザーが EDINET から取得する書類検索条件を指定する。
* **入力**：企業コード、提出日（開始日・終了日を両方指定。開始日≦終了日を必須バリデーション）、書類種別
* **出力**：検索条件オブジェクト
* **基本フロー**：

  1. ユーザーが条件を入力
  2. 「検索」ボタン押下
* **例外**：未入力の場合はエラー表示
* **優先度**：高

### **FR-002：EDINET から書類一覧取得**

* **概要**：検索条件に基づき EDINET API から書類一覧を取得する。
* **出力**：書類一覧（テーブル表示。提出日降順で並び替え、ユーザーによる並び順変更が可能）
* **例外**：接続失敗、該当ゼロ件

### **FR-003：EDINET 提出書類ファイルのダウンロード**

* **概要**：選択された書類の PDF/XBRL をダウンロードする。
* **出力**：ローカル一時保存（既定パス例：`./downloads/<EDINETコード>/` 配下）
* **基本フロー（補足）**：

  1. ダウンロードが成功した場合は保存先を UI に表示
  2. 失敗した場合はエラーメッセージを表示し、一定回数までのリトライ操作をユーザーに案内

### **FR-004：提出書類の内容抽出**

* **概要**：主要財務数値を自動抽出。
* **対象項目例**：売上高、営業利益、純利益、EPS など
* **出力**：抽出データ（DataFrame / dict）

### **FR-005：財務内容の可視化（Streamlit 表示）**

* **概要**：抽出データを UI に表示。
* **表示内容**：表、グラフ、増減コメント

### **FR-006：ログ出力**

* **概要**：処理内容・エラー情報をログファイルに記録。

---

## 5. 非機能要求（Non-functional Requirements）

### 5.1 パフォーマンス

* 書類一覧取得：10 秒以内（EDINET のレスポンスに依存）
* 抽出・表示：数秒程度

### 5.2 信頼性

* EDINET 障害・ネットワークエラーで落ちない

### 5.3 ユーザビリティ

* 初見でも操作可能
* プレースホルダー、説明文を適切に表示

### 5.4 保守性

* API アクセス部分はモジュール化
* 設定は `settings.yaml` などで管理

### 5.5 セキュリティ

* API キー（必要な場合）は **`.env` ファイルに保存し、環境変数として参照する方式**とする。
* `.env` ファイルは Git 管理対象外とし、リポジトリに含めない。
* API キーはコードに直接記述しない（ハードコーディング禁止）。
* ローカル以外のファイルにアクセスしない。

---

## 6. その他（Other Requirements）

### 6.1 将来の拡張

* 複数企業比較
* グラフ画像の保存
* Instagram 用画像生成

### 6.2 付録（Appendix）

* 画面ラフ図
* EDINET API パラメータ一覧
* 抽出対象項目リスト

---
